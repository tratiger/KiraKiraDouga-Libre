/**
 * 弾幕データパッケージフォーマット
 * インターフェース：GET https://api.bilibili.com/x/v2/dm/web/seg.so?type=1&oid=${AV番号}&pid=${パート番号}&segment_index=${動画セグメントインデックス}
 * リポジトリ：https://github.com/MoyuScript/bilibili-protobuf
 * 作者：MoyuScript
 */

syntax = "proto3";

package bilibili.danmaku;

/**
 * 個別弾幕情報
 */
message Danmaku {
	// 弾幕数値ID
	required int64 id = 1;
	// 動画内での弾幕出現位置
	required int32 progress = 2;
	// 弾幕モード
	enum Mode {
		// スクロール弾幕
		SCROLL = 1;
		// 上部固定弾幕
		TOP = 5;
		// 下部固定弾幕
		BOTTOM = 4;
		// 逆スクロール弾幕
		REVERSED = 6;
	}
	required Mode mode = 3;
	// 弾幕サイズ
	enum Fontsize {
		XXS = 12;
		XS = 16;
		S = 18;
		M = 25;
		L = 36;
		XL = 45;
		XXL = 64;
	}
	required Fontsize font_size = 4;
	// 弾幕のRGBAカラー
	required uint32 color = 5;
	// 弾幕送信者のcrc32計算後のハッシュ値
	required string mid_hash = 6;
	// 弾幕内容
	required string content = 7;
	// 弾幕送信タイムスタンプ
	required int64 ctime = 8;
	// 弾幕リストでの表示ウェイト。数値が大きいほど上に表示される
	required int32 weight = 9;
	// 現在不明
	optional string action = 10;
	// 現在不明
	optional int32 pool = 11;
	// 弾幕文字列ID
	required string id_str = 12;
	// 現在不明
	optional int32 attr = 13;
}

/**
 * ルートノード
 */
message Root {
	// 弾幕配列
	repeated Danmaku danmakus = 1;
	// 弾幕がオフになっているか。オフの場合のみこのオプションが存在する
	optional bool is_close = 1;
}
